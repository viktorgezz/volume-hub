CREATE TABLE IF NOT EXISTS company(
    id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    name VARCHAR(300) NOT NULL,
    ticker VARCHAR(15) NOT NULL,
    figi VARCHAR(15) NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS metric(
    id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    id_company BIGINT NOT NULL unique REFERENCES company(id),
    standard_deviation NUMERIC(10, 3),
    average NUMERIC(20, 6),
    z_score NUMERIC(5, 3) DEFAULT 2.99,
    critical_value NUMERIC(20, 6),
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS candle(
    id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    id_company BIGINT NOT NULL REFERENCES company(id),
    volume BIGINT NOT NULL,
    time TIMESTAMP NOT NULL,
    open NUMERIC(20, 9) NOT NULL,
    close NUMERIC(20, 9) NOT NULL,
    high NUMERIC(20, 9) NOT NULL,
    low NUMERIC(20, 9) NOT NULL
);

